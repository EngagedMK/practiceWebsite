<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div class="testimonials">
      <div>
        <p class="testimonials__name">TESTIMONIALS</p>
        <p class="testimonials__describe">Our Customers Reviews</p>
      </div>

      <div class="wrapper">
        <ul class="carousel">
          <li>
            <div class="img">
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
            </div>
            <p class="testimonials__describe-wrapper">
              It was light, breathable, and felt like it was made just for me. I
              could move freely, dance, sit on the grass, and still feel
              completely put-together. It’s not just a dress — it’s a memory
              wrapped in fabric.
            </p>
            <div class="testimonials__customer">
              <div>
                <img
                  src="../assets/img/image.jpg"
                  width="100%"
                  height="100%"
                  class="testimonials__img-avatar"
                />
              </div>
              <div
                style="
                  display: flex;
                  flex-direction: column;
                  justify-content: space-around;
                  margin-left: 8px;
                "
              >
                <p class="testimonials__customer-name">Emily R.</p>
                <p class="testimonials__customer-address">From Australia</p>
              </div>
            </div>
          </li>
          <li>
            <div class="img">
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
            </div>
            <p class="testimonials__describe-wrapper">
              The cut hugs my waist just right without being tight, and the
              flare adds a soft, feminine shape. I paired it with a basic tee
              and sandals, and somehow it looked effortlessly chic. It’s now my
              go-to for both work and coffee dates.
            </p>
            <div class="testimonials__customer">
              <div>
                <img
                  src="../assets/img/image-3.jpg"
                  width="100%"
                  height="100%"
                  class="testimonials__img-avatar"
                />
              </div>
              <div
                style="
                  display: flex;
                  flex-direction: column;
                  justify-content: space-around;
                  margin-left: 8px;
                "
              >
                <p class="testimonials__customer-name">Sofia L.</p>
                <p class="testimonials__customer-address">From Canada</p>
              </div>
            </div>
          </li>
          <li>
            <div class="img">
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
            </div>
            <p class="testimonials__describe-wrapper">
              This dress gave me the best of both worlds. I wore it for my
              friend’s birthday brunch and felt confident all day. The fabric is
              soft and flows beautifully — and I love how it catches the light
              when I move. Truly timeless.
            </p>
            <div class="testimonials__customer">
              <div>
                <img
                  src="../assets/img/image-1.jpg"
                  width="100%"
                  height="100%"
                  class="testimonials__img-avatar"
                />
              </div>
              <div
                style="
                  display: flex;
                  flex-direction: column;
                  justify-content: space-around;
                  margin-left: 8px;
                "
              >
                <p class="testimonials__customer-name">Chloe M.</p>
                <p class="testimonials__customer-address">United Kingdom</p>
              </div>
            </div>
          </li>
          <li>
            <div class="img">
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
            </div>
            <p class="testimonials__describe-wrapper">
              I chose the peach-toned midi dress and wore it on a sunny
              afternoon by the lake. It felt romantic and light, and the way the
              skirt moved with the breeze made me feel like I was in a movie.
              This is what summer should feel like.
            </p>
            <div class="testimonials__customer">
              <div>
                <img
                  src="../assets/img/image-4.jpg"
                  width="100%"
                  height="100%"
                  class="testimonials__img-avatar"
                />
              </div>
              <div
                style="
                  display: flex;
                  flex-direction: column;
                  justify-content: space-around;
                  margin-left: 8px;
                "
              >
                <p class="testimonials__customer-name">Isabelle T.</p>
                <p class="testimonials__customer-address">From France</p>
              </div>
            </div>
          </li>
          <li>
            <div class="img">
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
              <i class="fa-solid fa-star testimonials__img"></i>
            </div>
            <p class="testimonials__describe-wrapper">
              When I opened the box, I could already tell this was something
              special. The fabric, the stitching, the way it fit my body —
              everything exceeded my expectations. I wore it on vacation and
              felt like the main character in every photo.
            </p>
            <div class="testimonials__customer">
              <div>
                <img
                  src="../assets/img/image-2.jpg"
                  width="100%"
                  height="100%"
                  class="testimonials__img-avatar"
                />
              </div>
              <div
                style="
                  display: flex;
                  flex-direction: column;
                  justify-content: space-around;
                  margin-left: 8px;
                "
              >
                <p class="testimonials__customer-name">Natalie K.</p>
                <p class="testimonials__customer-address">United States</p>
              </div>
            </div>
          </li>
        </ul>

        <div class="testimonials__customer-pagination">
          <!-- Dots sẽ được tạo bởi JavaScript -->
        </div>
      </div>
    </div>
  </body>
</html>

<script>
  const wrapper = document.querySelector(".wrapper");
  const carousel = document.querySelector(".carousel");
  const paginationContainer = document.querySelector(
    ".testimonials__customer-pagination"
  );

  let isDragging = false,
    isAutoPlay = true,
    startX,
    startScrollLeft,
    currentIndex = 0;

  const originalSlides = 5;
  let cardPerView = 3;
  let totalPages = 2;

  function calculateCardPerView() {
    const screenWidth = window.innerWidth;
    if (screenWidth <= 600) {
      cardPerView = 1;
    } else if (screenWidth <= 900) {
      cardPerView = 2;
    } else {
      cardPerView = 3;
    }
    totalPages = Math.ceil(originalSlides / cardPerView);
  }

  // Tạo pagination dots
  function createPaginationDots() {
    calculateCardPerView();
    paginationContainer.innerHTML = "";

    for (let i = 0; i < totalPages; i++) {
      const dot = document.createElement("button");
      dot.classList.add("pagination-dot");
      if (i === 0) dot.classList.add("active");
      dot.addEventListener("click", () => goToSlide(i));
      paginationContainer.appendChild(dot);
    }
  }

  // Khởi tạo carousel
  function initCarousel() {
    const firstCard = carousel.querySelector("li");
    if (!firstCard) return;

    carousel.classList.add("no-transition");
    carousel.scrollLeft = 0;
    carousel.classList.remove("no-transition");
    updatePagination();
  }

  function goToSlide(index) {
    currentIndex = index;
    const firstCard = carousel.querySelector("li");
    if (!firstCard) return;

    const scrollTo = index * (firstCard.offsetWidth * cardPerView);
    carousel.classList.add("smooth-scroll");
    carousel.scrollLeft = scrollTo;
    carousel.classList.remove("smooth-scroll");
    updatePagination();
  }

  function updatePagination() {
    const dots = paginationContainer.querySelectorAll(".pagination-dot");
    const firstCard = carousel.querySelector("li");
    if (!firstCard || dots.length === 0) return;

    const scrollPosition = carousel.scrollLeft;
    const itemWidth = firstCard.offsetWidth * cardPerView;
    let currentPage = Math.round(scrollPosition / itemWidth);

    currentPage = Math.max(0, Math.min(currentPage, totalPages - 1));

    // Cập nhật trạng thái active cho dots
    dots.forEach((dot, index) => {
      dot.classList.toggle("active", index === currentPage);
    });

    currentIndex = currentPage;
  }

  // Drag functionality
  const dragStart = (e) => {
    isDragging = true;
    carousel.classList.add("dragging");
    startX = e.pageX || (e.touches && e.touches[0].pageX);
    startScrollLeft = carousel.scrollLeft;
  };

  const dragging = (e) => {
    if (!isDragging) return;
    const x = e.pageX || (e.touches && e.touches[0].pageX);
    const newScrollLeft = startScrollLeft - (x - startX);
    if (
      newScrollLeft >= 0 &&
      newScrollLeft <= carousel.scrollWidth - carousel.offsetWidth
    ) {
      carousel.scrollLeft = newScrollLeft;
    }
  };

  const dragStop = () => {
    isDragging = false;
    carousel.classList.remove("dragging");

    const firstCard = carousel.querySelector("li");
    if (!firstCard) return;

    const itemWidth = firstCard.offsetWidth * cardPerView;
    const scrollPosition = carousel.scrollLeft;
    const currentPage = Math.floor(scrollPosition / itemWidth);
    const dragDistance = scrollPosition - startScrollLeft;
    const threshold = itemWidth / 2; // Half the width of an item group

    let targetPage = currentPage;

    // If dragged more than half an item group, move to the next or previous page
    if (Math.abs(dragDistance) > threshold) {
      if (dragDistance > 0) {
        // Dragged right (next page)
        targetPage = Math.min(currentPage + 1, totalPages - 1);
      } else {
        // Dragged left (previous page)
        targetPage = Math.max(currentPage - 1, 0);
      }
    }

    // Smoothly snap to the target page
    carousel.classList.add("smooth-scroll");
    carousel.scrollLeft = targetPage * itemWidth;
    carousel.classList.remove("smooth-scroll");

    updatePagination();
  };

  const handleScroll = () => {
    // Chỉ cập nhật pagination khi không kéo
    if (!isDragging) {
      updatePagination();
    }
  };

  carousel.addEventListener("mousedown", dragStart);
  carousel.addEventListener("mousemove", dragging);
  document.addEventListener("mouseup", dragStop);
  carousel.addEventListener("scroll", handleScroll);
  wrapper.addEventListener("mouseenter", () => {
    isAutoPlay = false;
  });
  wrapper.addEventListener("mouseleave", () => {
    isAutoPlay = true;
  });

  // Touch events for mobile
  carousel.addEventListener("touchstart", dragStart);
  carousel.addEventListener("touchmove", dragging);
  carousel.addEventListener("touchend", dragStop);

  // Responsive handling
  window.addEventListener("resize", () => {
    calculateCardPerView();
    createPaginationDots();
    initCarousel();
  });

  // Initialize everything
  calculateCardPerView();
  createPaginationDots();
  initCarousel();
</script>
